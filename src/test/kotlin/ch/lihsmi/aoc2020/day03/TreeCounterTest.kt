package ch.lihsmi.aoc2020.day03

import org.junit.jupiter.api.Assertions
import org.junit.jupiter.api.Test

class TreeCounterTest {

    fun sampleMap() =
        """
            ..##.......
            #...#...#..
            .#....#..#.
            ..#.#...#.#
            .#...##..#.
            ..#.##.....
            .#.#.#....#
            .#........#
            #.##...#...
            #...##....#
            .#..#...#.#
        """.trimIndent()

    fun quizMap() =
        """
            ........#..#.##.#..............
            ...#...............#.#.........
            ...#..#...#..##....#...........
            ...#.............#....#.....#..
            ..#......#..#...#.......#......
            ..............##...............
            #.......#.........#......#....#
            .#.....###.....#...#.#.#...#...
            #.....................#....#.#.
            .......#...................#...
            ...#.#...................#....#
            ....#....#.......#...#.........
            ..##.#............#..#.........
            .....##.#..............##..###.
            ...........#....#....#.........
            #.....#...#...#.#.#.#.##.#...#.
            .#...............#....##.......
            .....#..#......#....#.......##.
            .....#........#.......#........
            ...#...##...#..##...#.....##...
            .....#.........#.###...##...#..
            .#.##...#........#.#.#.#....#..
            ....#......##.#...#.....#....#.
            .......###..........#..#..#....
            ......#...#.##.................
            ....#...#...#.........#......#.
            .....#...........#...###....#..
            .....#...#.#.#....##.#......#.#
            ......#...#.....#..#..#........
            #......#..#...##........###....
            ##.....#....##..#.#.###.#...#..
            ........#....#.......#.....#..#
            #.#.#.##.#.#...................
            ..#...##....#......#.....##....
            .......#.##..#........##..#....
            .#.#....##......#.#..........#.
            #..............#............#..
            .#.#.#.#.#.####.#.#...##.......
            .#..#.....##.#.......#.##...#..
            ..#.#........#.............#.#.
            ..#.#..........#..#........#...
            ..#..#...#.......##...#.#....##
            ...#.....#.#.#.....#....#....#.
            .#...#......#.....#..##........
            ...#.......##.#.#.....#......#.
            ...........#.....#.#.......#...
            #...........#...#..#.#........#
            ....#......#..##........#..###.
            .#..#........................#.
            #.......#......#...#...#..#....
            ....#.#...#..#.#....#....##.#..
            .....#......#..#..........##.#.
            .#.....#...........#.........#.
            ...###.#...#.......#.#.........
            .......#....#..........#..#...#
            ......##..#.......#...##.......
            ..#..........#.......#.........
            ..........#..#..#..#..#........
            .#.................####...#.#.#
            ..##.....#............#........
            ....#.....###...#......#....#.#
            ...##.#...........#.##......#..
            #..##..#..#....#...#..#........
            ......#....#........#.......#..
            ......#.....#......###.........
            .#.....#.#......#.......#......
            ..#.........#..#..#........##.#
            ..#.#....#.....#....##....#.#..
            ...#.............##............
            ........#..#..#......#...#.....
            .....#.#...#...##.....#.....#..
            .#..#.#..........##...##.....#.
            ......##.#..........#...#.....#
            #.#.##......#....#..........#..
            ................#.......#.##...
            #.......#.....#.......#....#...
            #..#.....#.##..##...........#..
            .....#....#.#.##..........#..##
            #.......#.....#.##...........#.
            ........#.##........###..#.#...
            ........#..................#...
            #.........................#...#
            ....#.........#...#.#..#.....#.
            .#............#....#...........
            ..#.#...#..##...#.#.......#....
            .#.#....#...........#.........#
            ...#.#..........#.....#...#....
            ......#....#.#...............##
            ....##......###...##.##.....##.
            ............#.#....#.#.....#..#
            .....#..#.....#.#...###....#...
            .......##....##..#...##..#...##
            .....#.......##..#...#...#....#
            #.........##....#........###.#.
            ...#..##...#...#.........#.#.#.
            ....#.#.....#.....#............
            #........#....#..#........#....
            .......#....#...#..............
            #...#.........##.....###.#.....
            .#....##..#...#..##.........#..
            ....#.....#......##..#..#....#.
            #.#..#.........#........#......
            ..#.......#.........#.....###..
            ..#..........#...........#....#
            ..#...............#......#..#..
            ....#..#...#....###.....#..#..#
            #...#...#..#...........#....#..
            .#....#.#..#....#.#...........#
            .....#.....#..#....#..#....#...
            #.#..#...........#.#...........
            ..................#.#.......#..
            ...#.........#.....#..##....#..
            .........#.#...#.........##....
            ...#..#....#.....#...#..#......
            .#.##.....#....#....#......##..
            ##..#.........#.#....#...#.....
            #......#.#...#....#.#..#.......
            .......#.....#.....###....#.#..
            .#....##.#.....#...#.......#...
            .#.......#..#...#......#..#..##
            ...............#...#...........
            #..............#....#.#.#....#.
            ...........#..#.......#.##..#..
            ..#......#.#....#...#.#.....#..
            #..............................
            #..#....#..........#...#.......
            ......#.............#####......
            .#...###......#.#.#.##..#......
            ............#.##.....#.........
            .........#....##....#..........
            ###....#......#.......#........
            .#.......##..........#..#....#.
            #..#.....................#....#
            ........#...........#..........
            ..#..........#...#..#.........#
            ..#..#......##................#
            .....##..#...#..#..............
            .......#...##..#...............
            .......##..#.####....#....#.#..
            #.#..#..........#........##....
            ....##....#.#..#....#.#...#....
            ......#.......#...#.....#...#..
            ..#..#...#.....#.......###.....
            ...#.......#.#.#.......#.##....
            ...............#..#.#........#.
            .#....###.#......#.............
            .#..#...#....#.#..#.....#......
            .......#.##....#.#.##.##...#.#.
            ..#...#....#.#..##.#.....#...##
            ..#...#......#...#......#...#..
            ....#..#...#.#..#......#.......
            #..#...............#......#.##.
            .#....#...#..........#.#.....#.
            .#..#.#.#................#..#..
            .#....#.#...#..##.###..#...###.
            #.............#.....#.........#
            ...#.........#...#.......#..#..
            ......#..#.........#..........#
            ........##................#..#.
            ......#...#.#.....#......##....
            ...............#...#....#......
            ...#.#..#..#.....##.###..##..#.
            .#....##......#...#..##..#.....
            .....#.........##.##....#...#..
            .....#.#..................####.
            #.....#...#.............##....#
            #.#..........#...#..#..#.......
            #..#.#.........#...............
            ....#...#.........#...##.......
            ...........#.....#..##..#......
            #.....#.......#.#........#.....
            ..##..#.....#...##......#......
            ....#....#.....................
            ............#......#.........##
            .....##.............#.....##..#
            .......#.............#..#.#.##.
            .###...#......#..#........##.#.
            ..#.#...#.#....#.....#..#......
            ..#.#..#.##........#...#.......
            ........#.#...............#..#.
            ........##.......#...#.......#.
            ...#........##.#..........#.#.#
            ..#..###.#.#.......#.#......#..
            ....#..........#...#..#........
            ...#..#...#...#.#....#...#..#..
            ...#...#........#......##...#.#
            #...........#..........#..#.##.
            ...#..##..................#.#..
            ...##.#...#....#.#...#.####....
            .....#...#.#.#..#..............
            .....#..#.#.#..#...............
            ..#..#..##...#.#..#.....##....#
            .......#.#..#.....#....#.......
            ...#..#....#.........#...#.....
            ..............#.#...#...##.....
            ...................#...........
            .#......#.#...................#
            .##.....#........#.........#..#
            .##..##...#...................#
            ...#....#.#..#.#.#..#.....##...
            .......#..#....#......####.#...
            .##..#..##....#.......#........
            .#...#...........##............
            .....#.....#........#..........
            ....##..#....#.....#...........
            .#...#....................#....
            ....#.........#.......##.....#.
            .#....#..#.....#.##....#.......
            ....#..#.........#.#....#.#....
            .......#.........##....#.......
            ..#......#....#....#...#.......
            ........#..#.......#.##......#.
            ..#.....#......#...#..#.......#
            #..#.....##...#...#............
            .......##.......#........#...#.
            ..#......................#...#.
            ....##.#.............#......#..
            #.#............................
            ...##.#.....#.#............#.##
            ......#...#..#.........##......
            .#.......#.....##.......#.#....
            ...........#.#.........#..##...
            ...#..........#.##....#........
            ........#..#..#...#....#....#..
            ........##....#.#....#........#
            ..#........##....###....#......
            #................###...#...#...
            ................#.#..###......#
            ..#.....##.#................#..
            .....#...............#..#......
            ..#.......####.....#..#.#....##
            ..#.....#..#....#..............
            #.#...........#.#.....#..##....
            #.#..........#.......#...#.###.
            ........#....#...#..#.#........
            .#.....#......#..#..#..###..#..
            .#.........#.##.#.#......##....
            ..#.........#...##..#........#.
            .#...................#.........
            ...#.#........#................
            ............#.....#..##........
            ..#.....#.#......#.......#...#.
            ........#....##..##...#.....##.
            .#........#.#....#.#....#.#..#.
            #.#.......#....................
            .#..#...##.........#..#........
            .........#...............#.....
            ...#...#.....#......#.......#..
            ###......................#.#..#
            ...#.....####........#..#.....#
            #.#...#.#...................##.
            .........#.....................
            #..........##..#.....#....#....
            .......#...#.#.##.#..##........
            ..........#..#.#..#.#.......#.#
            .....................#.#...#...
            ...........#.#........#.#.#....
            .......#......#........#...#.#.
            .........#....................#
            .##.##....#...#.#.#.#..........
            #....##..#.##....#....#.......#
            .##.#...#...............#....#.
            .......#...#.###....#..........
            .....#....#...#..#.............
            #.........#.##....#.#.#........
            ..#...#.............##..#..#...
            #..##.......#..........#...#.#.
            .#..#.....#...........#......#.
            ......#......#..............##.
            .#...#..#...#..####.....#.....#
            ....##.......#..........##.....
            .#.....#.......#.....#.#...#...
            ..#..#..#.#...#......#.........
            ......#.#....#........#.......#
            ........#.......#..............
            ..#...#.#....#........#.......#
            ............#....#...##.#......
            .........#.............#..#....
            #.............#.#..##.......#..
            #....#...........###....#......
            ...#.....................#.....
            ....#.#..........#...#.......#.
            ......#..#.......#...#...#....#
            .#.#..#.....##.#........#......
            ...........#...#.#.............
            ...###............#...#..#.....
            ..#.#.......#...#.#..#.........
            .#......##...........#.....#.##
            .....##.....#....##...##.#.#...
            ..........#.#.#......#........#
            ..#.#........#....##....#.#....
            .#....#...##...........#....#..
            ##......#...#.......#..........
            .##...###..#...#......#..##.#.#
            ...........##.#..##...#.......#
            ..#..............##............
            ........#..#........#...#..#.#.
            ..#.............#......#...##..
            #...##....#...#....#....#.#....
            .#.#......#..##............#.#.
            .....###.#....##....#....#.....
            #.#.#..........#...#...#.#.#...
            .....#.#...........####........
            .....#....##...#.##..#......#..
            #....#.......#.##.......#..#...
            .....#.....#........#..........
            .......#.......#...#.##......#.
            ...#.........##...#.#.#......##
            #........#........#...#..#.....
            .#......#.#......#.#...#....#..
            #..#....##.....##..............
            ...#.##............#..........#
            .....#.#....#..#.#............#
            ..#......#...###.##.......###..
            ........#....#.#.#.#...........
            ............#..#........#.....#
            ....#...............#..........
            ......#....#....###..#.......##
            #...#...##....#.........#...#..
            ...........#.#.............#...
            ...#..#.....#..##.#....#......#
            ..#...#..#...#......#..........
            ....#..#....#.......#........#.
        """.trimIndent()

    @Test
    fun treeCountOnSampleMapIsAsExpected() {
        val treeCounter = TreeCounter(sampleMap().lines())
        val treeCount = treeCounter.count(1,3)
        Assertions.assertEquals(7, treeCount)
    }

    @Test
    fun treeCountOnQuizMapIsAsExpected() {
        val treeCounter = TreeCounter(quizMap().lines())
        val treeCount = treeCounter.count(1,3)
        Assertions.assertEquals(250, treeCount)
    }

    @Test
    fun treeCountOnSampleMapWithMultiSlopeIsAsExpected() {
        val treeCounter = TreeCounter(sampleMap().lines())

        val treeCount11 = treeCounter.count(1,1)
        val treeCount13 = treeCounter.count(1,3)
        val treeCount15 = treeCounter.count(1,5)
        val treeCount17 = treeCounter.count(1,7)
        val treeCount21 = treeCounter.count(2,1)

        val multipliedResult = treeCount11 * treeCount13 * treeCount15 * treeCount17 * treeCount21

        Assertions.assertEquals(336, multipliedResult)
    }

    @Test
    fun treeCountOnQuizMapWithMultiSlopeIsAsExpected() {
        val treeCounter = TreeCounter(quizMap().lines())

        val treeCount11 = treeCounter.count(1,1)
        val treeCount13 = treeCounter.count(1,3)
        val treeCount15 = treeCounter.count(1,5)
        val treeCount17 = treeCounter.count(1,7)
        val treeCount21 = treeCounter.count(2,1)

        val multipliedResult = treeCount11 * treeCount13 * treeCount15 * treeCount17 * treeCount21

        Assertions.assertEquals(1592662500, multipliedResult)
    }

}